#include "rocc.h"
#include "define.h"
#include <stdio.h>


uint64_t data = 0x3421L;



int add(int n)
{
	if(n<2)
		return 1;
	else
		return add(n-1) + add(n-2);
}

int add2(int a, int b)
{
	return a+b;
}
int i;

void DFG_init(uint64_t* RDS,uint64_t* RDT )
{
	for (i = 0; i < 1024; i++)
	{
		RDT[i] = 0;
    }	
	RDS[0] = 0 | 1<<63;
	RDS[1] = 0 | ((uint64_t)(1)<<32) | (uint64_t)(1)<<63;
	RDS[2] = 1 | ((uint64_t)(20)<<32) | (uint64_t)(1)<<63;
	RDS[3] = 21 | ((uint64_t)(1)<<32) | (uint64_t)(1)<<63;
	RDS[4] = 22 | ((uint64_t)(1)<<32) | (uint64_t)(1)<<63;
	RDS[5] = 0x0605000302010000;
	RDS[6] = 0x1413121110090807;
	RDS[7] = 0x2221201918171615;
	RDS[8] = 0x3029282726252423;
	RDS[9] = 0x3837363534333231;
	RDS[10] = 0x0000000200010000;

}
void CFG_init(uint64_t* CFG )
{

CFG[ 0x0] =0x8000000100000000L;
CFG[ 0x1] =0x0;
CFG[ 0x2] =0x8000000000000001L;
CFG[ 0x3] =0x0;
CFG[ 0x4] =0x10;
CFG[ 0x5] =0x0;
CFG[ 0x6] =0x20;
CFG[ 0x7] =0x0;
CFG[ 0x8] =0x30;
CFG[ 0x9] =0x0;
CFG[ 0xa] =0x40;
CFG[ 0xb] =0x0;
CFG[ 0xc] =0x50;
CFG[ 0xd] =0x0;
CFG[ 0xe] =0x0;
CFG[ 0xf] =0x0;
CFG[ 0x10] =0x0;
CFG[ 0x11] =0x8000000000000001L;
CFG[ 0x12] =0x0;
CFG[ 0x13] =0x8000000000000001L;
CFG[ 0x14] =0x0;
CFG[ 0x15] =0x0;
CFG[ 0x16] =0x0;
CFG[ 0x17] =0x0;
CFG[ 0x18] =0x0;
CFG[ 0x19] =0x0;
CFG[ 0x1a] =0x0;
CFG[ 0x1b] =0x0;
CFG[ 0x1c] =0x0;
CFG[ 0x1d] =0x0;
CFG[ 0x1e] =0x0;
CFG[ 0x1f] =0x0;
CFG[ 0x20] =0x0;
CFG[ 0x21] =0x0;
CFG[ 0x22] =0x0;
CFG[ 0x23] =0x0;
CFG[ 0x24] =0x8000000000000001L;
CFG[ 0x25] =0x8000000000000001L;
CFG[ 0x26] =0x0;
CFG[ 0x27] =0x0;
CFG[ 0x28] =0x0;
CFG[ 0x29] =0x0;
CFG[ 0x2a] =0x0;
CFG[ 0x2b] =0x0;
CFG[ 0x2c] =0x0;
CFG[ 0x2d] =0x0;
CFG[ 0x2e] =0x0;
CFG[ 0x2f] =0x0;
CFG[ 0x30] =0x0;
CFG[ 0x31] =0x0;
CFG[ 0x32] =0x0;
CFG[ 0x33] =0x0;
CFG[ 0x34] =0x0;
CFG[ 0x35] =0x0;
CFG[ 0x36] =0x8000000000000001L;
CFG[ 0x37] =0x8000000000000001L;
CFG[ 0x38] =0x0;
CFG[ 0x39] =0x0;
CFG[ 0x3a] =0x0;
CFG[ 0x3b] =0x0;
CFG[ 0x3c] =0x0;
CFG[ 0x3d] =0x0;
CFG[ 0x3e] =0x0;
CFG[ 0x3f] =0x0;
CFG[ 0x40] =0x0;
CFG[ 0x41] =0x0;
CFG[ 0x42] =0x0;
CFG[ 0x43] =0x0;
CFG[ 0x44] =0x0;
CFG[ 0x45] =0x0;
CFG[ 0x46] =0x0;
CFG[ 0x47] =0x0;
CFG[ 0x48] =0x0;
CFG[ 0x49] =0x8000000000000001L;
CFG[ 0x4a] =0x0;
CFG[ 0x4b] =0x0;
CFG[ 0x4c] =0x8000000000000001L;
CFG[ 0x4d] =0x0;
CFG[ 0x4e] =0x8000000000000001L;
CFG[ 0x4f] =0x8000000000000001L;
CFG[ 0x50] =0x0;
CFG[ 0x51] =0x0;
CFG[ 0x52] =0x0;
CFG[ 0x53] =0x0;
CFG[ 0x54] =0x0;
CFG[ 0x55] =0x0;
CFG[ 0x56] =0x8000000000000001L;
CFG[ 0x57] =0x0;
CFG[ 0x58] =0x0;
CFG[ 0x59] =0x0;
CFG[ 0x5a] =0x0;
CFG[ 0x5b] =0x0;
CFG[ 0x5c] =0x0;
CFG[ 0x5d] =0x8000000000000001L;
CFG[ 0x5e] =0x0;
CFG[ 0x5f] =0x0;
CFG[ 0x60] =0x80001048;
}


void inst(uint64_t* instruction,uint64_t CFG_ADDR,uint64_t RES_ADDR )
{

instruction[0]=1097 + (CFG_ADDR<< 12);
instruction[1]=1161 + (RES_ADDR<< 12);
instruction[2]=0xb60040004c9;
instruction[3]=0x80549;
instruction[4]=0x4000000000001c02;
instruction[5]=0x55;
instruction[6]=0x4001901ca;
instruction[7]=0x100c;
instruction[8]=0x4c;
instruction[9]=0x800000002808000eL;
instruction[10]=0xffffffffff00000fL;
instruction[11]=0x4c3090;
instruction[12]=0x402090;
instruction[13]=0x404090;
instruction[14]=0x40043012456;
instruction[15]=0x1c1;
instruction[16]=0xc553004;
instruction[17]=0x8000000008540546L;
instruction[18]=0x8000000070384090L;
instruction[19]=0x4553803;
instruction[20]=0x8000000008540548L;
instruction[21]=0x1c0810;
instruction[22]=0x8000000002800806L;
instruction[23]=0x8000000002840806L;
instruction[24]=0x2249;
instruction[25]=0x9141814;
instruction[26]=0x80000000706c0150L;
instruction[27]=0x8000000001500506L;
instruction[28]=0x1c1;

}





int foo(int b)
{
	int a;
	a = 1;
	a++;
	return a+b;
}

int main(void)
{
	asm(".word 0x0400000b");
	printf("Begin test...\n");
	asm(".word 0x0200000b");
	uint64_t instruction[256];

    //DFI  test
	uint64_t RDT[1024]={0};
	uint64_t RDS[256]={0};
	uint64_t CFG[256]={0};
	CFG_init(RDS);

	
	inst(instruction,RDS,RDS+0x60);
	ROCC_INSTRUCTION_SS(0,12345678,0,32);
	ROCC_INSTRUCTION_SS(0,instruction,128,0);
	ROCC_INSTRUCTION_SS(0,0,0xffffffffff,4);


	int tmp = add2(1,2);
	int (*func_p) (int ,int);
	func_p = add;
	int c=0;
	c = add(10);


	
	asm(".word 0x0400000b");
	printf("C fib is -- %d\n",c);
	
}
